# Game Server

___

### Сюжет и механика игры:

Игра представляет собой поисковый квест, в котором игрок управляет собакой, собирающей потерянные вещи на картах города. Основная цель — найти и доставить как можно больше предметов в бюро находок, зарабатывая очки.

#### Игровой процесс:

***Управление персонажем:***

*Игрок управляет собакой с помощью клавиш:*

"W" – движение вперёд

"S" – движение назад

"A" – поворот влево

"D" – поворот вправо

По всему городу разбросаны потерянные вещи, которые собака может подбирать.

Для сбора предмета необходимо подойти к нему.

Все найденные предметы автоматически кладутся в сумку, но у неё есть ограниченная вместимость.

Доставка предметов

Когда сумка заполнена (или по желанию игрока), необходимо отнести вещи в офис бюро находок.

***Система очков:***

Баллы начисляются за каждую вещь, доставленную в бюро находок.

***Отключение за неактивность:***

Если игрок долго не двигает собаку, игра считает его неактивным.

Через определённое время бездействия происходит автоматическое отключение.

После отключения результаты игрока сохраняются в таблице рекордов.

# Опции запуска Game Server

| Опция | Значение | Описание|
|--|--|--|
| -h [--help] |  | Показать все опции |
| -с [--config-file] | file | Установить путь к конфигурационному файлу |
| -w [--www-root] | dir | Установить корень статических файлов |
| -t [--tick-period] | milliseconds | Установить период тика |
| --randomize-spawn-points |  | Генерировать игрового персонажа в рандомных позициях |
| --save-state-period | milliseconds | Установить период автосохранения состояния игры |
| --state-file | file | Установить имя файла для автосохранения состояния игры |

# Запуск Game Server в docker

Запускать сервер можно в docker:

	docker build -t my_http_server .
	docker run --rm -p 80:8080 my_http_server
  
Из докерфайла можно узнать все детали сборки запуска, если что-то идёт не так локально.

После этого можно открыть в браузере:

http://127.0.0.1:8080/api/v1/maps для получения списка карт и
http://127.0.0.1:8080/api/v1/map/map1 для получения подробной информации о карте map1
http://127.0.0.1:8080/ для чтения статического контента (в каталоге static)

# Сборка

***Требования:***

- Ubuntu 22.04
- GCC 11.3
- Conan 1.x
- Python 3
- PostgreSQL

Сборка под Linux

	$ mkdir build && cd build 
	$ conan install .. --build=missing -s build_type=Release -s compiler.libcxx=libstdc++11
	$ cmake .. -DCMAKE_BUILD_TYPE=Release
	$ cmake --build .

Перед запуском установить переменную окружения:

	export GAME_DB_URL="postgres://postgres:Mys3Cr3t@localhost:30432/"
  
## Запуск 

	./game_server -c ../../data/config.json -w ../../static -t 100




